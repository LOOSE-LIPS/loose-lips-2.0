var svelte = require('svelte/compiler');

var parser = require.resolve('./parser/collect-stories').replace(/[/\\]/g, '/');

function process(src, filename) {
  var result = svelte.compile(src, {
    format: 'cjs',
    filename: filename,
    dev: true
  });
  var code = result.js ? result.js.code : result.code;
  var z = {
    code: "".concat(code, "\n    const { default: parser } = require('").concat(parser, "');\n    const md = parser(module.exports.default, {});\n    module.exports = { default: md.meta, ...md.stories };\n    Object.defineProperty(exports, \"__esModule\", { value: true });"),
    map: result.js ? result.js.map : result.map
  };
  return z;
}

exports.process = process;